<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Money with Gpt</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://unpkg.com/lottie-web@5.12.2/build/player/lottie.min.js"></script>
    <style>
        /* ================================================= */
        /* –û–°–ù–û–í–ù–´–ï –°–¢–ò–õ–ò –ò –¢–ï–ú–´ TELEGRAM */
        /* ================================================= */
        :root {
            /* –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è —Ç–µ–º–Ω–æ–π/—Å–≤–µ—Ç–ª–æ–π —Ç–µ–º—ã (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é - —Å–≤–µ—Ç–ª–∞—è) */
            --tg-text-color: #000000;
            --tg-bg-color: #FFFFFF;
            --tg-secondary-bg-color: #F8F8F8;
            --tg-hint-color: #9C9C9C;
            --tg-link-color: #007AFF;
            --tg-button-color: #007AFF; 
            --tg-button-text-color: #FFFFFF;
            --task-price-color: #4CAF50; 
            --mir-logo-color: #FF7B00;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            margin: 0;
            padding: 0 0 70px 0; /* –û—Ç—Å—Ç—É–ø –¥–ª—è –Ω–∏–∂–Ω–µ–π –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ */
            background-color: var(--tg-theme-bg-color, var(--tg-bg-color));
            color: var(--tg-theme-text-color, var(--tg-text-color));
            overflow-x: hidden;
            -webkit-user-select: none;
            user-select: none;
            min-height: 100vh;
        }
        
        /* –ì–ª–∞–≤–Ω—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –≤—Å–µ—Ö —ç–∫—Ä–∞–Ω–æ–≤, –∫—Ä–æ–º–µ –æ–Ω–±–æ—Ä–¥–∏–Ω–≥–∞ */
        #app-container {
            height: 100vh;
            overflow-y: auto;
        }

        /* –û–±—â–∏–µ —Å—Ç–∏–ª–∏ –∑–∞–≥–æ–ª–æ–≤–∫–∞ */
        .header {
            display: flex;
            align-items: center;
            padding: 15px;
            font-size: 17px;
            font-weight: 600;
            line-height: 22px;
            background-color: var(--tg-theme-bg-color, var(--tg-bg-color));
            position: sticky;
            top: 0;
            z-index: 50; 
        }
        .back-arrow {
            font-size: 24px;
            margin-right: 15px;
            cursor: pointer;
            font-weight: 400;
        }
        .content-wrap {
            padding: 0 15px;
        }

        /* --- –§–∏–ª—å—Ç—Ä—ã --- */
        .task-filters {
            display: flex;
            overflow-x: scroll;
            padding: 0 15px 15px 15px;
            margin: 0 -15px;
            gap: 8px;
            -webkit-overflow-scrolling: touch;
        }
        .task-filters::-webkit-scrollbar { display: none; }

        .filter-button {
            flex-shrink: 0;
            padding: 7px 15px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 500;
        }
        .filter-button.active {
            background-color: var(--tg-theme-button-color, var(--tg-button-color));
            color: var(--tg-theme-button-text-color, var(--tg-button-text-color));
        }
        .filter-button:not(.active) {
            background-color: var(--tg-theme-secondary-bg-color, #EFEFEF);
            color: var(--tg-theme-text-color, var(--tg-text-color));
        }

        /* --- –≠–ª–µ–º–µ–Ω—Ç –∑–∞–¥–∞–Ω–∏—è --- */
        .task-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px 0;
            border-bottom: 1px solid var(--tg-theme-secondary-bg-color, #EFEFEF);
        }
        .task-left {
             display: flex;
             align-items: center;
        }
        .task-icon {
            width: 40px; height: 40px; border-radius: 8px;
            display: flex; justify-content: center; align-items: center;
            background-color: var(--tg-theme-secondary-bg-color);
            margin-right: 12px; font-size: 20px;
        }
        .task-title { font-weight: 500; font-size: 16px; }
        .task-hint { font-size: 13px; color: var(--tg-theme-hint-color); }
        .task-action-btn {
            padding: 6px 12px;
            background-color: var(--tg-theme-button-color);
            color: var(--tg-theme-button-text-color);
            border: none;
            border-radius: 18px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            flex-shrink: 0;
            margin-left: 15px;
        }

        /* --- –î–µ—Ç–∞–ª–∏ –∑–∞–¥–∞–Ω–∏—è –∏ –∑–∞–≥—Ä—É–∑–∫–∞ --- */
        .task-detail-price {
            font-size: 40px;
            font-weight: 700;
            color: var(--task-price-color);
            margin: 10px 0;
        }
        .task-detail-images {
            display: flex;
            gap: 10px;
            margin: 15px 0;
            flex-direction: column; 
        }
        .upload-area {
            width: 100%;
            height: 80px;
            border: 2px dashed var(--tg-theme-hint-color);
            border-radius: 8px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 16px;
            color: var(--tg-theme-hint-color);
            cursor: pointer;
            transition: all 0.2s;
            box-sizing: border-box;
            text-align: center;
        }
        .upload-area.uploaded {
            border: 2px solid var(--task-price-color);
            background-color: rgba(76, 175, 80, 0.1);
            color: var(--task-price-color);
        }

        /* --- –°—Ç–∏–ª–∏ –∫–æ—à–µ–ª—å–∫–∞ --- */
        .wallet-balance-wrap { 
            text-align: center; 
            padding: 20px 0 10px 0; 
            line-height: 1.2;
            color: var(--tg-theme-hint-color);
        }
        .wallet-balance {
            font-size: 40px;
            font-weight: 700;
            margin: 10px 0;
            color: var(--tg-theme-text-color);
        }
        .wallet-actions {
            display: flex;
            justify-content: space-around;
            padding: 15px 0;
            border-bottom: 1px solid var(--tg-theme-secondary-bg-color);
        }
        .wallet-action-item {
            text-align: center;
            cursor: pointer;
            font-size: 14px;
            color: var(--tg-theme-hint-color);
        }
        .wallet-action-item .icon {
            font-size: 24px;
            margin-bottom: 5px;
            background-color: var(--tg-theme-secondary-bg-color);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 0 auto 5px auto;
        }

        .transaction-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid var(--tg-theme-secondary-bg-color);
        }
        .transaction-amount-text {
            font-weight: 600;
            color: var(--tg-theme-text-color); 
        }
        .transaction-card-info {
            font-size: 13px;
            color: var(--tg-theme-hint-color);
            text-align: right;
        }
        .mir-logo { color: var(--mir-logo-color); font-weight: bold; }

        /* --- –ù–∏–∂–Ω—è—è –Ω–∞–≤–∏–≥–∞—Ü–∏—è --- */
        .bottom-nav {
            position: fixed; bottom: 0; left: 0; width: 100%;
            display: flex; justify-content: space-around; align-items: center;
            height: 60px;
            background-color: var(--tg-theme-secondary-bg-color, #F8F8F8);
            border-top: 1px solid #D1D1D1; z-index: 1000;
        }
        .nav-item {
            flex: 1; text-align: center; color: var(--tg-theme-hint-color); padding: 5px 0;
            cursor: pointer;
        }
        .nav-item.active { color: var(--tg-theme-text-color); font-weight: 600; }
        .nav-icon { font-size: 24px; }
        
        /* --- –°—Ç–∏–ª–∏ –æ–Ω–±–æ—Ä–¥–∏–Ω–≥–∞ (–∞–Ω–∏–º–∞—Ü–∏—è) --- */
        #onboarding-screen {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: var(--tg-theme-bg-color); 
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            animation: fadeIn 0.6s;
        }
        .logo-circle {
            width: 240px;
            height: 240px;
            position: relative;
            margin-bottom: 50px;
        }
        .lottie-icon {
            position: absolute; width: 76px; height: 76px;
            top: 50%; left: 50%; transform: translate(-50%, -50%);
        }
        .circle-item {
            position: absolute; width: 76px; height: 76px; border-radius: 18px;
            background: var(--tg-theme-bg-color);
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            animation: float 7s infinite ease-in-out;
            background-size: 70%; background-repeat: no-repeat;
            background-position: center;
        }
        
        /* –ü–æ–∑–∏—Ü–∏–∏ –∏–∫–æ–Ω (–û–ë–ù–û–í–õ–ï–ù–û –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–ï–ú) */
        /* –í–ù–ò–ú–ê–ù–ò–ï: nth-child(1) - —ç—Ç–æ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π lottie-icon, –ø–æ—ç—Ç–æ–º—É –Ω–∞—á–∏–Ω–∞–µ–º —Å (2) */
        
        /* 1. –õ–û–î–ö–ê (Sailing) - –í–ê–®–ê –ò–ö–û–ù–ö–ê 1 */
        .circle-item:nth-child(2) { 
            top: 10px; left: 50px; animation-delay: 0s;
            background-image: url('https://avatars.mds.yandex.net/i?id=65552bd6636ba7cef3b635ed6fcf995103df8ffc-2469813-images-thumbs&n=13'); 
        }
        
        /* 2. CHATGPT - –í–ê–®–ê –ò–ö–û–ù–ö–ê 2 */
        .circle-item:nth-child(3) { 
            top: 30px; right: 20px; animation-delay: 1s;
            background-image: url('https://avatars.mds.yandex.net/i?id=1b626eed0c89889b68153bf578e0860964743e76-4219822-images-thumbs&n=13');
        }
        
        /* 3. –ö–ò–¢ (Blue Whale/Dolphin) - –í–ê–®–ê –ò–ö–û–ù–ö–ê 3 */
        .circle-item:nth-child(4) { 
            bottom: 40px;
            right: 30px;
            animation-delay: 2s;
            background-image: url('https://avatars.mds.yandex.net/i?id=ebf169d41433e2d2c1be2081881ca1a3ee4bff2b-4600463-images-thumbs&n=13');
            background-size: 80%;
        }

        /* 4. –ò–ö–û–ù–ö–ê 4 */
        .circle-item:nth-child(5) { 
            bottom: 10px; left: 40px; animation-delay: 3s; 
            background-image: url('https://avatars.mds.yandex.net/i?id=ec3f3a85560aa891621d0b7de06b130dec700313-5480663-images-thumbs&n=13'); 
        }
        
        /* 5. –ò–ö–û–ù–ö–ê 5 */
        .circle-item:nth-child(6) { 
            top: 70px; left: 10px; animation-delay: 4s;
            background-image: url('https://avatars.mds.yandex.net/i?id=b55adaff5419e5f601e836d756843795ece7f587-8552056-images-thumbs&n=13'); 
        }

        @keyframes float {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-25px) rotate(8deg); }
        }

        .onboarding-title {
            font-size: 32px; font-weight: 800; text-align: center;
            background: linear-gradient(90deg, var(--tg-theme-link-color), var(--task-price-color));
            -webkit-background-clip: text; background-clip: text;
            -webkit-text-fill-color: transparent; color: transparent;
            margin-bottom: 16px;
        }
        .onboarding-subtitle {
            font-size: 18px; color: var(--tg-theme-hint-color);
            text-align: center; margin-bottom: 60px;
        }
        .onboarding-btn {
            background: var(--tg-theme-button-color); color: var(--tg-theme-button-text-color);
            border: none; border-radius: 16px; padding: 18px 70px;
            font-size: 18px; font-weight: 600; cursor: pointer;
            box-shadow: 0 10px 30px rgba(0,0,0,0.25);
        }
        .onboarding-btn:active { transform: scale(0.95); }

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes fadeOut { from { opacity: 1; } to { opacity: 0; } }
        
        /* –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ —ç–∫—Ä–∞–Ω—ã, –∫—Ä–æ–º–µ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ */
        .app-screen {
            display: none;
            min-height: calc(100vh - 60px); /* –í—ã—á–∏—Ç–∞–µ–º –≤—ã—Å–æ—Ç—É nav-bar */
        }

        /* –û–±—â–∏–µ —Å—Ç–∏–ª–∏ –¥–ª—è —ç–∫—Ä–∞–Ω–æ–≤ "–ú–æ–¥–µ—Ä–∞—Ü–∏—è" –∏ "–û–¥–æ–±—Ä–µ–Ω–∏–µ" */
        .full-screen-message {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: var(--tg-theme-bg-color, var(--tg-bg-color));
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            z-index: 1001; /* –í—ã—à–µ nav bar */
            animation: fadeIn 0.3s;
        }
    </style>
</head>
<body>

    <div id="onboarding-screen">
        <div class="logo-circle">
            <div id="center-lottie" class="lottie-icon"></div>
            <div class="circle-item"></div> 
            <div class="circle-item"></div>
            <div class="circle-item"></div>
            <div class="circle-item"></div>
            <div class="circle-item"></div> 
        </div>
        <div class="onboarding-title">WebXStudio</div>
        <div class="onboarding-subtitle">–í—ã–ø–æ–ª–Ω—è–π –∑–∞–¥–∞–Ω–∏—è ‚Äî –∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞–π —Ä–µ–∞–ª—å–Ω—ã–µ –¥–µ–Ω—å–≥–∏</div>
        <button class="onboarding-btn" onclick="closeOnboarding()">–ù–∞—á–∞—Ç—å</button>
    </div>

    <div id="app-container" style="display: none;">
        
        <div id="screen-tasks" class="app-screen">
            <div class="header" style="justify-content: space-between; padding-right: 25px;">
                 –ó–∞–¥–∞–Ω–∏—è
                 <span style="font-size: 20px;">‚öôÔ∏è</span>
            </div>
            
            <div class="task-filters">
                <div class="filter-button active" onclick="filterTasks('all')">–í—Å–µ (6)</div>
                <div class="filter-button" onclick="filterTasks('text')">–¢–µ–∫—Å—Ç–æ–≤—ã–µ</div>
                <div class="filter-button" onclick="filterTasks('photo')">–§–æ—Ç–æ/–ò–ò</div>
            </div>
            
            <div class="content-wrap task-list" id="task-list">
                
                <div class="task-item task-text">
                    <div class="task-left">
                        <div class="task-icon">‚è≥</div> 
                        <div class="task-info-main">
                            <div class="task-title">–ù–∞–ø–∏—Å–∞—Ç—å –±–æ–ª—å—à–æ–π –∞–≤–∏—Ç–æ –æ—Ç–∑—ã–≤</div>
                            <div class="task-hint">450 ‚ÇΩ ‚Ä¢ 3 –¥–µ–∫. 2025</div>
                        </div>
                    </div>
                    <button class="task-action-btn" onclick="openTaskDetails('review', '–ù–∞–ø–∏—Å–∞—Ç—å –Ω–µ–±–æ–ª—å—à–æ–π –æ—Ç–∑—ã–≤ –æ –ø—Ä–æ–¥—É–∫—Ç–µ', 800, 'text', '–ù–∞–ø–∏—à–∏—Ç–µ –Ω–µ–±–æ–ª—å—à–æ–π, –Ω–æ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—ã–π –æ—Ç–∑—ã–≤ –æ –ø—Ä–æ–¥—É–∫—Ç–µ (500-800 —Å–∏–º–≤–æ–ª–æ–≤). –í—Å—Ç–∞–≤—å—Ç–µ —Ç–µ–∫—Å—Ç –≤ –ø–æ–ª–µ –≤–≤–æ–¥–∞.')">
                        –í—ã–ø–æ–ª–Ω–∏—Ç—å
                    </button>
                </div>

                <div class="task-item task-photo">
                    <div class="task-left">
                        <div class="task-icon">üå≥</div> 
                        <div class="task-info-main">
                            <div class="task-title">–°–¥–µ–ª–∞—Ç—å —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—é</div>
                            <div class="task-hint">520 ‚ÇΩ ‚Ä¢ 3 –¥–µ–∫. 2025</div>
                        </div>
                    </div>
                    <button class="task-action-btn" onclick="openTaskDetails('photo_tree', '–°–¥–µ–ª–∞—Ç—å —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—é', 520, 'photo', '–°–¥–µ–ª–∞—Ç—å —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—é –¥–µ—Ä–µ–≤–∞, –≤—ã—Å–æ—Ç–∞ –∫–æ—Ç–æ—Ä–æ–≥–æ –≤–∏–∑—É–∞–ª—å–Ω–æ –±—É–¥–µ—Ç –±–æ–ª—å—à–µ, —á–µ–º 3 –º–µ—Ç—Ä–∞. –§–æ—Ç–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–º. –ü—Ä–∏–∫—Ä–µ–ø–∏—Ç–µ —Ñ–æ—Ç–æ.')">
                        –í—ã–ø–æ–ª–Ω–∏—Ç—å
                    </button>
                </div>

                <div class="task-item task-text">
                    <div class="task-left">
                        <div class="task-icon">‚úçÔ∏è</div> 
                        <div class="task-info-main">
                            <div class="task-title">–ù–∞–ø–∏—Å–∞—Ç—å –Ω–µ–±–æ–ª—å—à–æ–π –æ—Ç–∑—ã–≤</div>
                            <div class="task-hint">800 ‚ÇΩ ‚Ä¢ 3 –¥–µ–∫. 2025</div>
                        </div>
                    </div>
                    <button class="task-action-btn" onclick="openTaskDetails('review', '–ù–∞–ø–∏—Å–∞—Ç—å –Ω–µ–±–æ–ª—å—à–æ–π –æ—Ç–∑—ã–≤ –æ –ø—Ä–æ–¥—É–∫—Ç–µ', 800, 'text', '–ù–∞–ø–∏—à–∏—Ç–µ –Ω–µ–±–æ–ª—å—à–æ–π, –Ω–æ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—ã–π –æ—Ç–∑—ã–≤ –æ –ø—Ä–æ–¥—É–∫—Ç–µ (500-800 —Å–∏–º–≤–æ–ª–æ–≤). –í—Å—Ç–∞–≤—å—Ç–µ —Ç–µ–∫—Å—Ç –≤ –ø–æ–ª–µ –≤–≤–æ–¥–∞.')">
                        –í—ã–ø–æ–ª–Ω–∏—Ç—å
                    </button>
                </div>

                <div class="task-item task-photo">
                    <div class="task-left">
                        <div class="task-icon">ü§ñ</div>
                        <div class="task-info-main">
                            <div class="task-title">–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ª–æ–≥–æ—Ç–∏–ø</div>
                            <div class="task-hint">900 ‚ÇΩ ‚Ä¢ 1 –¥–µ–∫. 2025</div>
                        </div>
                    </div>
                    <button class="task-action-btn" onclick="openTaskDetails('logo_gen', '–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ª–æ–≥–æ—Ç–∏–ø –≤ Midjourney', 900, 'photo', '–ò—Å–ø–æ–ª—å–∑—É—è Midjourney, —Å–æ–∑–¥–∞–π—Ç–µ 4 –≤–∞—Ä–∏–∞–Ω—Ç–∞ –ª–æ–≥–æ—Ç–∏–ø–∞ –¥–ª—è IT-–∞–≥–µ–Ω—Ç—Å—Ç–≤–∞ –≤ —Å—Ç–∏–ª–µ –º–∏–Ω–∏–º–∞–ª–∏–∑–º. –ü—Ä–∏—à–ª–∏—Ç–µ —Ñ–∏–Ω–∞–ª—å–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ.')">
                        –í—ã–ø–æ–ª–Ω–∏—Ç—å
                    </button>
                </div>
                
                <div class="task-item task-text">
                    <div class="task-left">
                        <div class="task-icon">üìñ</div>
                        <div class="task-info-main">
                            <div class="task-title">–ü–µ—Ä–µ–≤–µ—Å—Ç–∏ —Ç–µ–∫—Å—Ç</div>
                            <div class="task-hint">550 ‚ÇΩ ‚Ä¢ 2 –¥–µ–∫. 2025</div>
                        </div>
                    </div>
                    <button class="task-action-btn" onclick="openTaskDetails('translate', '–ü–µ—Ä–µ–≤–µ—Å—Ç–∏ —Ç–µ–∫—Å—Ç —Å –∞–Ω–≥–ª. –Ω–∞ —Ä—É—Å.', 550, 'text', '–ü–µ—Ä–µ–≤–µ–¥–∏—Ç–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–π –∞–Ω–≥–ª–æ—è–∑—ã—á–Ω—ã–π —Ç–µ–∫—Å—Ç (–æ–∫–æ–ª–æ 1500 —Å–∏–º–≤–æ–ª–æ–≤) –Ω–∞ —Ä—É—Å—Å–∫–∏–π —è–∑—ã–∫. –í—Å—Ç–∞–≤—å—Ç–µ –ø–µ—Ä–µ–≤–µ–¥–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç.')">
                        –í—ã–ø–æ–ª–Ω–∏—Ç—å
                    </button>
                </div>

                <div class="task-item task-text">
                    <div class="task-left">
                        <div class="task-icon">üåê</div>
                        <div class="task-info-main">
                            <div class="task-title">–ü–µ—Ä–µ–≤–µ—Å—Ç–∏ —Ç–µ–∫—Å—Ç</div>
                            <div class="task-hint">250 ‚ÇΩ ‚Ä¢ 1 –¥–µ–∫. 2025</div>
                        </div>
                    </div>
                    <button class="task-action-btn" onclick="openTaskDetails('translate', '–ü–µ—Ä–µ–≤–µ—Å—Ç–∏ —Ç–µ–∫—Å—Ç —Å –∞–Ω–≥–ª. –Ω–∞ —Ä—É—Å.', 550, 'text', '–ü–µ—Ä–µ–≤–µ–¥–∏—Ç–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–π –∞–Ω–≥–ª–æ—è–∑—ã—á–Ω—ã–π —Ç–µ–∫—Å—Ç (–æ–∫–æ–ª–æ 1500 —Å–∏–º–≤–æ–ª–æ–≤) –Ω–∞ —Ä—É—Å—Å–∫–∏–π —è–∑—ã–∫. –í—Å—Ç–∞–≤—å—Ç–µ –ø–µ—Ä–µ–≤–µ–¥–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç.')">
                        –í—ã–ø–æ–ª–Ω–∏—Ç—å
                    </button>
                </div>

                <div class="task-item task-text">
                    <div class="task-left">
                        <div class="task-icon">üíø</div>
                        <div class="task-info-main">
                            <div class="task-title">–ê–Ω–∞–ª–∏–∑ —é—Ç—É–±-—Ä–æ–ª–∏–∫–∞</div>
                            <div class="task-hint">1500 ‚ÇΩ ‚Ä¢ 2 –¥–µ–∫. 2025</div>
                        </div>
                    </div>
                    <button class="task-action-btn" onclick="openTaskDetails('translate', '–ü–µ—Ä–µ–≤–µ—Å—Ç–∏ —Ç–µ–∫—Å—Ç —Å –∞–Ω–≥–ª. –Ω–∞ —Ä—É—Å.', 550, 'text', '–ü–µ—Ä–µ–≤–µ–¥–∏—Ç–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–π –∞–Ω–≥–ª–æ—è–∑—ã—á–Ω—ã–π —Ç–µ–∫—Å—Ç (–æ–∫–æ–ª–æ 1500 —Å–∏–º–≤–æ–ª–æ–≤) –Ω–∞ —Ä—É—Å—Å–∫–∏–π —è–∑—ã–∫. –í—Å—Ç–∞–≤—å—Ç–µ –ø–µ—Ä–µ–≤–µ–¥–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç.')">
                        –í—ã–ø–æ–ª–Ω–∏—Ç—å
                    </button>
                </div>

                <div class="task-item task-text">
                    <div class="task-left">
                        <div class="task-icon">üé•</div>
                        <div class="task-info-main">
                            <div class="task-title">–û–ø–∏—Å–∞–Ω–∏–µ –¥–ª—è YouTube-–≤–∏–¥–µ–æ</div>
                            <div class="task-hint">650 ‚ÇΩ ‚Ä¢ 2 –¥–µ–∫. 2025</div>
                        </div>
                    </div>
                    <button class="task-action-btn" onclick="openTaskDetails('video_desc', '–°–æ—Å—Ç–∞–≤–∏—Ç—å –æ–ø–∏—Å–∞–Ω–∏–µ –¥–ª—è YouTube', 650, 'text', '–ü—Ä–∏–¥—É–º–∞–π—Ç–µ —Ü–µ–ø–ª—è—é—â–µ–µ SEO-–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –¥–ª—è –Ω–æ–≤–æ–≥–æ –≤–∏–¥–µ–æ –æ –±–∏–∑–Ω–µ—Å–µ –≤ IT. –¢—Ä–µ–±—É–µ–º—ã–π –æ–±—ä–µ–º: 300 —Å–ª–æ–≤. –í—Å—Ç–∞–≤—å—Ç–µ —Ç–µ–∫—Å—Ç.')">
                        –í—ã–ø–æ–ª–Ω–∏—Ç—å
                    </button>
                </div>

                <div class="task-item task-text">
                    <div class="task-left">
                        <div class="task-icon">üë§</div>
                        <div class="task-info-main">
                            <div class="task-title">–ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ</div>
                            <div class="task-hint">350 ‚ÇΩ ‚Ä¢ 1 –¥–µ–∫. 2025</div>
                        </div>
                    </div>
                    <button class="task-action-btn" onclick="openTaskDetails('new_user', '–ü—Ä–∏–≥–ª–∞—Å–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è', 350, 'text', '–ù–∞–ø–∏—à–∏—Ç–µ –∫–æ—Ä–æ—Ç–∫–∏–π, –Ω–æ —É–±–µ–¥–∏—Ç–µ–ª—å–Ω—ã–π —Ç–µ–∫—Å—Ç-–ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –¥–ª—è –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –∫–∞–Ω–∞–ª. –í—Å—Ç–∞–≤—å—Ç–µ —Ç–µ–∫—Å—Ç.')">
                        –í—ã–ø–æ–ª–Ω–∏—Ç—å
                    </button>
                </div>
                
                <div style="height: 20px;"></div> 
            </div>
        </div>

        <div id="screen-details" class="app-screen">
            <div class="header">
                <span class="back-arrow" onclick="showScreen('tasks')">‚Üê</span>
                <span id="detail-title"></span>
            </div>
            <div class="content-wrap">
                <div id="detail-price" class="task-detail-price"></div>
                
                <h4 style="margin-bottom: 5px;">–£—Å–ª–æ–≤–∏–µ:</h4>
                <p id="detail-description" style="margin-top: 0; font-size: 15px;"></p>

                <h4 id="upload-instruction" style="margin-bottom: 5px;">–ü—Ä–∏–∫—Ä–µ–ø–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç:</h4>
                <div id="task-images-area" class="task-detail-images">
                    
                    <div id="upload-field" class="upload-area">
                        <span class="upload-icon">‚ùì</span>
                        <span>–ù–∞–∂–º–∏—Ç–µ "–í–´–ü–û–õ–ù–ò–¢–¨" –¥–ª—è –Ω–∞—á–∞–ª–∞...</span>
                    </div>
                    
                    <input 
                        type="file" 
                        id="file-input" 
                        style="display: none;" 
                        accept="image/*, application/pdf, .txt" 
                        onchange="handleFileSelection(event)"
                    >
                    
                    <textarea 
                        id="text-input" 
                        style="width: 100%; height: 100px; padding: 10px; box-sizing: border-box; border: 1px solid var(--tg-theme-hint-color); border-radius: 8px; font-size: 15px; background-color: var(--tg-theme-secondary-bg-color); color: var(--tg-theme-text-color); display: none;" 
                        placeholder="–í–∞—à —Ä–µ–∑—É–ª—å—Ç–∞—Ç..."></textarea>
                    
                </div>
                
                <p style="font-size: 13px; color: var(--tg-theme-hint-color);">
                    *–î–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∑–∞–¥–∞–Ω–∏—è –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–∏–∫—Ä–µ–ø–∏—Ç—å —Ñ–∞–π–ª/—Å–∫—Ä–∏–Ω—à–æ—Ç/—Ç–µ–∫—Å—Ç.
                </p>
            </div>
        </div>
        
        <div id="screen-wallet" class="app-screen">
            <div class="header" style="justify-content: space-between; padding-right: 25px;">
                 –ö–æ—à–µ–ª—ë–∫
                 <span style="font-size: 20px;"></span>
            </div>
            
            <div class="wallet-balance-wrap">
                –ë–∞–ª–∞–Ω—Å:
                <div id="wallet-balance-value" class="wallet-balance">8 950 ‚ÇΩ</div>
                <div style="font-size: 20px; cursor: pointer;">
                    <span class="icon">
                        <span style="font-weight: 500; font-size: 20px;" onclick="toggleBalanceVisibility()">
                            &#128065;
                        </span>
                    </span>
                </div>
            </div>
            
            <div class="wallet-actions">
                <div class="wallet-action-item" onclick="alert('–û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å—Ä–µ–¥—Å—Ç–≤–∞')">
                    <div class="icon">‚Üë</div>
                    <span style="color: var(--tg-theme-link-color);">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</span>
                </div>
                <div class="wallet-action-item" onclick="alert('–î–æ–±–∞–≤–∏—Ç—å —Ä–µ–∫–≤–∏–∑–∏—Ç—ã')"> 
                    <div class="icon">+</div>
                    <span style="color: var(--tg-theme-link-color);">–î–æ–±–∞–≤–∏—Ç—å —Ä–µ–∫–≤–∏–∑–∏—Ç—ã</span>
                </div>
                <div class="wallet-action-item" onclick="alert('–ù–∞—Å—Ç—Ä–æ–π–∫–∏')">
                    <div class="icon">...</div>
                    <span style="color: var(--tg-theme-link-color);">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</span>
                </div>
            </div>
            
            <div class="content-wrap">
                <h3 style="margin-top: 20px; font-weight: 600;">–û–ø–µ—Ä–∞—Ü–∏–∏</h3>
                <div class="transaction-list">
                    <div class="transaction-item">
                        <div style="display: flex; align-items: center;">
                            <div class="nav-icon" style="margin-right: 10px; font-size: 18px; color: var(--tg-theme-link-color);">‚Üë</div>
                            <div>
                                <div class="transaction-amount-text">8 950 ‚ÇΩ</div>
                                <div class="task-hint">3 –¥–µ–∫. 2025, 15:45</div>
                            </div>
                        </div>
                        <div class="transaction-card-info">
                            **** 2843<br><span class="mir-logo">–ú–ò–†</span>
                        </div>
                    </div>
                    <div class="transaction-item">
                         <div style="display: flex; align-items: center;">
                            <div class="nav-icon" style="margin-right: 10px; font-size: 18px; color: var(--tg-theme-link-color);">‚Üë</div>
                            <div>
                                <div class="transaction-amount-text">2 350 ‚ÇΩ</div>
                                <div class="task-hint">2 –¥–µ–∫. 2025, 18:30</div>
                            </div>
                        </div>
                        <div class="transaction-card-info">
                            **** 2843<br><span class="mir-logo">–ú–ò–†</span>
                        </div>
                    </div>
                    <div class="transaction-item">
                        <div style="display: flex; align-items: center;">
                            <div class="nav-icon" style="margin-right: 10px; font-size: 18px; color: var(--tg-theme-link-color);">‚Üë</div>
                            <div>
                                <div class="transaction-amount-text">10 200 ‚ÇΩ</div>
                                <div class="task-hint">1 –¥–µ–∫. 2025, 12:12</div>
                            </div>
                        </div>
                        <div class="transaction-card-info">
                            **** 2843<br><span class="mir-logo">–ú–ò–†</span>
                        </div>
                    </div>
                </div>
                <div style="height: 20px;"></div> 
            </div>
        </div>

    </div>
    
    <div class="bottom-nav" style="display: none;">
        <div id="nav-tasks" class="nav-item active" onclick="showScreen('tasks')">
            <div class="nav-icon">‚ò∞</div>
            <div>–ó–∞–¥–∞–Ω–∏—è</div>
        </div>
        <div id="nav-home" class="nav-item" onclick="showScreen('home')">
            <div class="nav-icon">üè†</div>
            <div>–î–æ–º–∏–∫</div>
        </div>
        <div id="nav-wallet" class="nav-item" onclick="showScreen('wallet')">
            <div class="nav-icon">üí≥</div>
            <div>–ö–æ—à–µ–ª–µ–∫</div>
        </div>
    </div>
    
    <div id="screen-moderation" class="full-screen-message" style="display: none;">
        <h2 id="moderation-status">–†–µ–∑—É–ª—å—Ç–∞—Ç –Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏...</h2>
        <p style="font-size: 50px;">‚è≥</p>
    </div>
    
    <div id="screen-approval" class="full-screen-message" style="display: none;">
        <h2 id="approval-status" style="color: var(--task-price-color);"></h2>
        <p style="font-size: 20px;">–°—Ä–µ–¥—Å—Ç–≤–∞ –∑–∞—á–∏—Å–ª–µ–Ω—ã –Ω–∞ –í–∞—à –±–∞–ª–∞–Ω—Å.</p>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        const mainButton = tg.MainButton;
        
        let currentTaskId = null; 
        let currentTaskPrice = 0;
        let currentTaskType = null; 
        let isFileUploaded = false; 
        let currentBalance = 8950; // –ù–∞—á–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å
        
        const formatCurrency = (amount) => `${amount.toLocaleString('ru-RU')} ‚ÇΩ`;

        // === –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø TG –ò –¢–ï–ú–´ ===
        tg.ready();
        
        if (tg.themeParams) {
            for (const key in tg.themeParams) {
                document.documentElement.style.setProperty(`--tg-${key}`, tg.themeParams[key]);
            }
        }
        
        function updateBalanceUI() {
            document.getElementById('wallet-balance-value').innerText = formatCurrency(currentBalance);
        }

        // === LOTTIE –ê–ù–ò–ú–ê–¶–ò–ò –ò –û–ù–ë–û–†–î–ò–ù–ì ===
        const lottieUrls = [
            "https://cdn.lottiefiles.com/packages/lf20_6CqhC0.json", // –ü–∏—Å—å–º–æ/–ö–æ–Ω–≤–µ—Ä—Ç (–¶–µ–Ω—Ç—Ä)
        ];
        
        function loadLottie(container, url, speed = 1) {
            lottie.loadAnimation({
                container: container,
                renderer: 'svg',
                loop: true,
                autoplay: true,
                path: url
            }).setSpeed(speed);
        }

        function initLottie() {
            const centerLottie = document.getElementById('center-lottie');
            if (centerLottie) {
                 loadLottie(centerLottie, lottieUrls[0], 0.8); 
            }
        }

        function closeOnboarding() {
            const onboarding = document.getElementById('onboarding-screen');
            onboarding.style.animation = 'fadeOut 0.3s forwards';
            
            document.getElementById('app-container').style.display = 'block';
            document.querySelector('.bottom-nav').style.display = 'flex';
            
            setTimeout(() => {
                onboarding.style.display = 'none';
                showScreen('tasks'); 
            }, 300);
        }
        
        window.onload = initLottie;

        // --- –û–ë–†–ê–ë–û–¢–ß–ò–ö –ì–õ–ê–í–ù–û–ô –ö–ù–û–ü–ö–ò ---
        mainButton.onClick(() => {
            const buttonText = mainButton.text;
            if (buttonText === '–í–´–ü–û–õ–ù–ò–¢–¨') {
                startExecution();
            } else if (buttonText === '–ó–ê–í–ï–†–®–ò–¢–¨') {
                finishTaskExecution();
            } else if (buttonText === '–ó–ê–ü–†–û–°–ò–¢–¨ –í–´–í–û–î') {
                initiateWithdrawal();
            }
        });

        // --- –õ–û–ì–ò–ö–ê –ü–ï–†–ï–ö–õ–Æ–ß–ï–ù–ò–Ø –≠–ö–†–ê–ù–û–í (SPA) ---
        function showScreen(screenName) {
            if (screenName === 'home') {
                 alert('–†–∞–∑–¥–µ–ª "–î–æ–º–∏–∫" –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω.');
                 return;
            }

            // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ —ç–∫—Ä–∞–Ω—ã
            document.querySelectorAll('.app-screen').forEach(screen => {
                screen.style.display = 'none';
            });
            // –°–∫—Ä—ã–≤–∞–µ–º —ç–∫—Ä–∞–Ω—ã –º–æ–¥–µ—Ä–∞—Ü–∏–∏/–æ–¥–æ–±—Ä–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –±—ã—Ç—å –∞–∫—Ç–∏–≤–Ω—ã
            document.getElementById('screen-moderation').style.display = 'none';
            document.getElementById('screen-approval').style.display = 'none';
            
            mainButton.hide();

            const screenElement = document.getElementById(`screen-${screenName}`);
            if (screenElement) {
                screenElement.style.display = 'block';
            }

            document.querySelectorAll('.nav-item').forEach(item => item.classList.remove('active'));
            const navItem = document.getElementById(`nav-${screenName}`);
            if (navItem) {
                navItem.classList.add('active');
            }

            if (screenName === 'wallet') {
                updateBalanceUI();
                mainButton.setText('–ó–ê–ü–†–û–°–ò–¢–¨ –í–´–í–û–î');
                // –ö–Ω–æ–ø–∫–∞ –≤—ã–≤–æ–¥–∞ –∞–∫—Ç–∏–≤–Ω–∞ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–º –±–∞–ª–∞–Ω—Å–µ
                const isActive = currentBalance > 0;
                mainButton.setParams({ 
                    is_active: isActive, 
                    is_visible: true, 
                    color: isActive ? (tg.themeParams.button_color || '#007AFF') : tg.themeParams.hint_color
                });
            } else if (screenName === 'details') {
                mainButton.setText('–í–´–ü–û–õ–ù–ò–¢–¨');
                mainButton.setParams({ 
                    is_active: true, 
                    is_visible: true, 
                    color: tg.themeParams.button_color || '#007AFF' 
                });
                resetUploadField();
            } else if (screenName === 'tasks') {
                filterTasks('all'); 
            }
        }

        // --- –õ–û–ì–ò–ö–ê –û–¢–ö–†–´–¢–ò–Ø –î–ï–¢–ê–õ–ï–ô –ó–ê–î–ê–ù–ò–Ø ---
        function openTaskDetails(id, title, price, type, description) {
            currentTaskId = id;
            currentTaskPrice = price;
            currentTaskType = type; // 'text' –∏–ª–∏ 'photo'
            
            document.getElementById('detail-title').innerText = title;
            document.getElementById('detail-price').innerText = formatCurrency(price);
            document.getElementById('detail-description').innerText = description;
            
            showScreen('details');
        }
        
        // --- –õ–û–ì–ò–ö–ê –§–ò–õ–¨–¢–†–ê–¶–ò–ò ---
        function filterTasks(category) {
            const tasks = document.querySelectorAll('.task-item');
            let count = 0;

            tasks.forEach(task => {
                const isText = task.classList.contains(`task-text`);
                const isPhoto = task.classList.contains(`task-photo`);

                if (category === 'all' || 
                    (category === 'text' && isText) ||
                    (category === 'photo' && isPhoto)) 
                {
                    task.style.display = 'flex';
                    count++;
                } else {
                    task.style.display = 'none';
                }
            });
            
            document.querySelectorAll('.filter-button').forEach(btn => btn.classList.remove('active'));
            const activeFilter = document.querySelector(`.filter-button[onclick="filterTasks('${category}')"]`);
            if (activeFilter) {
                activeFilter.classList.add('active');
                // –û–±–Ω–æ–≤–ª—è–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤ —Å–∫–æ–±–∫–∞—Ö, —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —Ñ–∏–ª—å—Ç—Ä "–í—Å–µ" –∏–ª–∏ –∞–∫—Ç–∏–≤–Ω—ã–π
                activeFilter.innerText = activeFilter.innerText.split('(')[0].trim() + ` (${count})`;
            }
        }
        
        // --- –®–∞–≥ 1: –ù–∞—á–∏–Ω–∞–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ ---
        function startExecution() {
            const uploadField = document.getElementById('upload-field');
            const fileInput = document.getElementById('file-input');
            const textInput = document.getElementById('text-input');

            // –û—á–∏—â–∞–µ–º –ø—Ä–æ—à–ª—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
            fileInput.value = ''; 
            textInput.value = '';
            
            // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ UI –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞ –∑–∞–¥–∞–Ω–∏—è
            if (currentTaskType === 'photo') {
                uploadField.innerHTML = '<span class="upload-icon">üì∑</span><span>–ù–∞–∂–º–∏—Ç–µ, —á—Ç–æ–±—ã –∑–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–æ—Ç–æ/—Å–∫—Ä–∏–Ω—à–æ—Ç</span>';
                uploadField.onclick = handleUploadClick; 
                textInput.style.display = 'none';
                fileInput.accept = 'image/*, application/pdf'; // –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ/—Ñ–∞–π–ª–æ–≤
            } else if (currentTaskType === 'text') {
                uploadField.innerHTML = '<span class="upload-icon">üìù</span><span>–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –≤ –ø–æ–ª–µ –Ω–∏–∂–µ</span>';
                uploadField.onclick = null; // –î–µ–ª–∞–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –Ω–µ–∫–ª–∏–∫–∞–±–µ–ª—å–Ω—ã–º
                textInput.style.display = 'block';
                // –ê–∫—Ç–∏–≤–∞—Ü–∏—è –∫–Ω–æ–ø–∫–∏ –ø—Ä–∏ –≤–≤–æ–¥–µ —Ç–µ–∫—Å—Ç–∞ (–∏–º–∏—Ç–∞—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏)
                textInput.oninput = () => {
                     // –£—Å–ª–æ–≤–∏–µ: —Ç–µ–∫—Å—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –¥–ª–∏–Ω–Ω–µ–µ 20 —Å–∏–º–≤–æ–ª–æ–≤ –¥–ª—è –∏–º–∏—Ç–∞—Ü–∏–∏ "–∑–∞–≥—Ä—É–∑–∫–∏"
                     const isValid = textInput.value.trim().length > 20; 
                     isFileUploaded = isValid;
                     mainButton.setParams({
                         is_active: isValid,
                         color: isValid ? (tg.themeParams.button_color || '#007AFF') : tg.themeParams.hint_color
                     });
                };
            }
            
            mainButton.setText('–ó–ê–í–ï–†–®–ò–¢–¨');
            mainButton.setParams({ 
                is_active: false,
                is_visible: true,
                color: tg.themeParams.hint_color // –ù–µ–∞–∫—Ç–∏–≤–Ω–∞—è –∫–Ω–æ–ø–∫–∞
            }); 
            
            tg.showPopup({
                 title: '–ó–∞–¥–∞–Ω–∏–µ –Ω–∞—á–∞—Ç–æ!',
                 message: '–í—Ä–µ–º—è –ø–æ—à–ª–æ. –ü—Ä–∏–∫—Ä–µ–ø–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∏ –Ω–∞–∂–º–∏—Ç–µ "–ó–ê–í–ï–†–®–ò–¢–¨".'
            });
        }

        // --- –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–ª–∏–∫–∞ –ø–æ –æ–±–ª–∞—Å—Ç–∏ –∑–∞–≥—Ä—É–∑–∫–∏ (–¢–æ–ª—å–∫–æ –¥–ª—è —Ñ–æ—Ç–æ/—Ñ–∞–π–ª–æ–≤) ---
        function handleUploadClick() {
            document.getElementById('file-input').click(); // –í—ã–∑–æ–≤ –Ω–∞—Ç–∏–≤–Ω–æ–≥–æ –¥–∏–∞–ª–æ–≥–∞
        }

        // --- –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –ø–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞ —Ñ–∞–π–ª–∞ ---
        function handleFileSelection(event) {
            const fileInput = event.target;
            const uploadField = document.getElementById('upload-field');
            
            if (fileInput.files.length > 0) {
                const fileName = fileInput.files[0].name;
                
                uploadField.innerHTML = `<span class="upload-icon">‚úÖ</span><span>–§–∞–π–ª –∑–∞–≥—Ä—É–∂–µ–Ω: ${fileName}</span>`;
                uploadField.classList.add('uploaded');
                uploadField.onclick = null; // –û—Ç–∫–ª—é—á–∏—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω—ã–π –∫–ª–∏–∫
                isFileUploaded = true;

                // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫—É "–ó–ê–í–ï–†–®–ò–¢–¨"
                mainButton.setParams({
                    is_active: true,
                    color: tg.themeParams.button_color || '#007AFF'
                 });
            } else {
                 // –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–º–µ–Ω–∏–ª –≤—ã–±–æ—Ä, –æ—Å—Ç–∞–≤–ª—è–µ–º –ø–æ–ª–µ "–ù–∞–∂–º–∏—Ç–µ..."
                 uploadField.innerHTML = '<span class="upload-icon">üì∑</span><span>–ù–∞–∂–º–∏—Ç–µ, —á—Ç–æ–±—ã –∑–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–æ—Ç–æ/—Å–∫—Ä–∏–Ω—à–æ—Ç</span>';
                 uploadField.classList.remove('uploaded');
                 uploadField.onclick = handleUploadClick;
                 isFileUploaded = false;
            }
        }

        function resetUploadField() {
            const uploadField = document.getElementById('upload-field');
            const textInput = document.getElementById('text-input');
            
            uploadField.innerHTML = '<span class="upload-icon">‚ùì</span><span>–ù–∞–∂–º–∏—Ç–µ "–í–´–ü–û–õ–ù–ò–¢–¨" –¥–ª—è –Ω–∞—á–∞–ª–∞...</span>';
            uploadField.classList.remove('uploaded');
            uploadField.onclick = null;
            textInput.style.display = 'none';
            textInput.value = '';
            textInput.oninput = null;
            isFileUploaded = false;
        }

        // --- –®–∞–≥ 2: –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –∏ –º–æ–¥–µ—Ä–∞—Ü–∏—è ---
        function finishTaskExecution() {
            if (!isFileUploaded) {
                 tg.showAlert('–°–Ω–∞—á–∞–ª–∞ –ø—Ä–∏–∫—Ä–µ–ø–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç!');
                 return;
            }

            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —ç–∫—Ä–∞–Ω –º–æ–¥–µ—Ä–∞—Ü–∏–∏
            document.getElementById('screen-moderation').style.display = 'flex'; 
            document.getElementById('moderation-status').innerText = '–†–µ–∑—É–ª—å—Ç–∞—Ç –Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏...';
            mainButton.hide();

            // –ò–º–∏—Ç–∞—Ü–∏—è –æ–∂–∏–¥–∞–Ω–∏—è
            setTimeout(() => {
                currentBalance += currentTaskPrice;
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —ç–∫—Ä–∞–Ω –æ–¥–æ–±—Ä–µ–Ω–∏—è
                document.getElementById('screen-moderation').style.display = 'none';
                document.getElementById('screen-approval').style.display = 'flex'; 
                document.getElementById('approval-status').innerText = `‚úÖ –ó–∞–¥–∞–Ω–∏–µ –æ–¥–æ–±—Ä–µ–Ω–æ! (+${formatCurrency(currentTaskPrice)})`;
                document.getElementById('approval-status').style.color = 'var(--task-price-color)';
                document.querySelector('#screen-approval p').innerText = '–°—Ä–µ–¥—Å—Ç–≤–∞ –∑–∞—á–∏—Å–ª–µ–Ω—ã –Ω–∞ –í–∞—à –±–∞–ª–∞–Ω—Å.'; // –°–±—Ä–æ—Å —Ç–µ–∫—Å—Ç–∞

                tg.sendData(JSON.stringify({ 
                    action: "task_approved", 
                    task_id: currentTaskId, 
                    amount: currentTaskPrice 
                })); 

                setTimeout(() => {
                    document.getElementById('screen-approval').style.display = 'none'; 
                    showScreen('wallet');
                }, 2000); 
            }, 3000); 
        }
        
        // --- –õ–û–ì–ò–ö–ê –í–´–í–û–î–ê –°–†–ï–î–°–¢–í ---
        function initiateWithdrawal() {
            if (currentBalance <= 0) {
                 tg.showAlert('–í–∞—à –±–∞–ª–∞–Ω—Å —Ä–∞–≤–µ–Ω 0 ‚ÇΩ.');
                 return;
            }

            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —ç–∫—Ä–∞–Ω –º–æ–¥–µ—Ä–∞—Ü–∏–∏ (–¥–ª—è –∑–∞–ø—Ä–æ—Å–∞)
            document.getElementById('screen-moderation').style.display = 'flex'; 
            document.getElementById('moderation-status').innerText = '–ó–∞–ø—Ä–æ—Å –Ω–∞ –≤—ã–≤–æ–¥ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è...';
            mainButton.hide();
            
            const withdrawalAmount = currentBalance; 

            // –ò–º–∏—Ç–∞—Ü–∏—è –æ–∂–∏–¥–∞–Ω–∏—è
            setTimeout(() => {
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —ç–∫—Ä–∞–Ω –æ–¥–æ–±—Ä–µ–Ω–∏—è (–¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –≤—ã–≤–æ–¥–∞)
                document.getElementById('screen-moderation').style.display = 'none';
                document.getElementById('screen-approval').style.display = 'flex'; 
                document.getElementById('approval-status').innerText = `üí∏ –ó–∞–ø—Ä–æ—Å –Ω–∞ –≤—ã–≤–æ–¥ ${formatCurrency(withdrawalAmount)} –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω!`;
                document.getElementById('approval-status').style.color = 'var(--tg-theme-text-color)';
                document.querySelector('#screen-approval p').innerText = '–°—Ä–µ–¥—Å—Ç–≤–∞ –ø–æ—Å—Ç—É–ø—è—Ç –≤ —Ç–µ—á–µ–Ω–∏–µ 3 —Ä–∞–±–æ—á–∏—Ö –¥–Ω–µ–π.';
                
                currentBalance = 0; 
                
                tg.sendData(JSON.stringify({ 
                    action: "withdrawal_request", 
                    amount: withdrawalAmount, 
                    user_id: tg.initDataUnsafe.user.id 
                }));
                
                setTimeout(() => {
                    document.getElementById('screen-approval').style.display = 'none';
                    showScreen('wallet');
                }, 2000); 
            }, 4000); 
        }
        
        // --- –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–∫—Ä—ã—Ç–∏—è/–ø–æ–∫–∞–∑–∞ –±–∞–ª–∞–Ω—Å–∞ ---
        function toggleBalanceVisibility() {
            const balanceElement = document.getElementById('wallet-balance-value');
            if (balanceElement.innerText.includes('****')) {
                balanceElement.innerText = formatCurrency(currentBalance);
            } else {
                balanceElement.innerText = '**** ‚ÇΩ';
            }
        }

    </script>
</body>
</html>

